package dataAccessLayer;

import java.util.ArrayList;
import java.util.List;

import javax.persistence.EntityManager;
import javax.persistence.EntityManagerFactory;
import javax.persistence.Persistence;
import javax.persistence.TypedQuery;

import model.Game;
import model.Player;

public class GameDataAccess {
	  public static EntityManagerFactory emf;
	  public static EntityManager em;
	  
	  public GameDataAccess() {
			emf = Persistence.createEntityManagerFactory("TFL");
			em = emf.createEntityManager();
			em.getTransaction().begin();
	  }
	  
	  public void listGames() {
			TypedQuery<Game> query = em.createQuery("SELECT g FROM Game g", Game.class);
			List<Game> result = new ArrayList<Game>();
			result = query.getResultList();
		   
			for (Game player : result) {
				System.out.println(player.toString());
			}
			
			TypedQuery<Player> querynew = em
				.createQuery("SELECT c FROM Player c WHERE c.username = :name AND c.password=:pass", Player.class);
			querynew.setParameter("name", username);
			querynew.setParameter("pass", password);
			Player play = new Player();
			try {
			    play = querynew.getSingleResult();
			    if (play.getId() != 0) {
				System.out.println(play.toString());
				for (Player p : result) {
				    if ((p.getUsername().compareTo(username) == 0) && (p.getPassword().compareTo(password) == 0)) {
					return true;
				    }
				}
			    }
			} catch (Exception ex) {
			    System.out.println("Username or password incorrect!");
			}
			return false;
		    }
}
