package views;

import javax.faces.application.FacesMessage;
import javax.faces.bean.ApplicationScoped;
import javax.faces.bean.ManagedBean;
import javax.faces.context.FacesContext;

import dataAccessLayer.PlayerDataAccess;
import model.Player;
 
@ManagedBean(name = "changePassView")
@ApplicationScoped
public class ChangePassView {
	private String oldPass;
	private String newPass;
	private String confirmPass;
	public String getOldPass() {
		return oldPass;
	}
	public void setOldPass(String oldPass) {
		this.oldPass = oldPass;
	}
	public String getNewPass() {
		return newPass;
	}
	public void setNewPass(String newPass) {
		this.newPass = newPass;
	}
	public String getConfirmPass() {
		return confirmPass;
	}
	public void setConfirmPass(String confirmPass) {
		this.confirmPass = confirmPass;
	}
	
	 public void login() {
	    	
			PlayerDataAccess pda = new PlayerDataAccess();
			if ((this.username != null) && (this.password != null)) {
				currentPlayer=new Player();
				currentPlayer = pda.loginUser(this.username, this.password);
				
			    if (currentPlayer!=null) {
			    	this.playedGames=this.currentPlayer.getGamePlayers().size();
			    	this.winner=this.currentPlayer.getGameWinners().size();
			    	this.looser=this.currentPlayer.getGameLosers().size();
			    	if(currentPlayer.getType()==null)
			    	{
			    		FacesContext.getCurrentInstance().addMessage(null, new FacesMessage(FacesMessage.SEVERITY_WARN, "Warning!", "This username does not have rights!"));
			    		return "/index";
			    	}
			    	else
			    	{
			    		if(currentPlayer.getType()==1)
			    		{
			    			return "/resources/user";
			    		}
			    		else
			    		{
			    			return "/resources/adminuser";
			    		}
			    	}
			    }
			}
			FacesContext.getCurrentInstance().addMessage(null, new FacesMessage(FacesMessage.SEVERITY_WARN, "Warning!", "Incorrect username or password!"));
			return "/index";
		    }
}
