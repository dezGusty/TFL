package dataAccessLayer;

import java.io.Serializable;
import javax.faces.bean.ApplicationScoped;
import javax.faces.bean.ManagedBean;
import javax.persistence.EntityManager;
import helpers.DatabaseConnection;
import model.Player;
import model.PlayerRating;

@ManagedBean(name = "playerRatingAccess")
@ApplicationScoped
public class PlayerRatingAccess implements Serializable{

	/**
	 * 
	 */
	private static final long serialVersionUID = 1L;
	
	 public static PlayerRating RegisterNewRating(PlayerRating playerRating)
	 {
			try {
				EntityManager em = DatabaseConnection.GetConnection();
				em.getTransaction().begin();
				em.persist(playerRating);
				em.getTransaction().commit();
				em.refresh(playerRating);
				em.close();
			} catch (Exception ex) {
				System.out.println(ex.getMessage());
			}
			return playerRating;
	 }
		  
	 public static void DeleteRating(int playerId,int ratingId)
	  {
		 EntityManager em = DatabaseConnection.GetConnection();
		 em.getTransaction().begin();

		 PlayerRating playerRating=em.find(PlayerRating.class, ratingId);
		 if(playerRating !=null)
		 {
			em.remove(playerRating);
		 }
		 em.getTransaction().commit();
		 em.close();
	  }
	 
	  public static void main(String[] args) {
		  Player p=PlayerDataAccess.FindPlayer(18);
			System.out.println(p.getPlayerRatings().size());
			PlayerRating pl=p.getPlayerRatings().get(0);
			p=DeleteRating(p.getId(), pl.getId());
			System.out.println(p.getPlayerRatings().size());
	}

}
